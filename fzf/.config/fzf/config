#!/hint/zsh

export FZF_PREVIEW_LINES=1000
export FZF_DEFAULT_COMMAND="fd --hidden --exclude '.clangd'"
FZF_DEFAULT_PREVIEW+=" if [[ -L {} ]] && [[ -d {} ]] then"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[Directory]${COLOR_NONE}\" symlink of \$(readlink -f {});"
FZF_DEFAULT_PREVIEW+=" exa --all --long --header --color=always {};"
FZF_DEFAULT_PREVIEW+=" elif [[ -d {} ]] then"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[Directory]${COLOR_NONE}\";"
FZF_DEFAULT_PREVIEW+=" exa --all --long --header --color=always {};"
FZF_DEFAULT_PREVIEW+=" elif [[ \$(echo {} | tail -c 4) = 'zip' ]] then"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[ZIP file]${COLOR_NONE}\";"
FZF_DEFAULT_PREVIEW+=" unzip -l {};"
FZF_DEFAULT_PREVIEW+=" elif [[ \$(echo {} | tail -c 4) = 'jar' ]] then"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[META-INF/MANIFEST.MF]${COLOR_NONE}\";"
FZF_DEFAULT_PREVIEW+=" unzip -q -c {} META-INF/MANIFEST.MF;"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[Contents]${COLOR_NONE}\";"
FZF_DEFAULT_PREVIEW+=" jar -tf {};"
FZF_DEFAULT_PREVIEW+=" elif [[ \$(echo {} | tail -c 4) = 'tar' ]] then"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[TAR file]${COLOR_NONE}\";"
FZF_DEFAULT_PREVIEW+=" tar -tf {};"
FZF_DEFAULT_PREVIEW+=" elif [[ \$(echo {} | tail -c 7) = 'tar.gz' ]] then"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[TAR file]${COLOR_NONE}\";"
FZF_DEFAULT_PREVIEW+=" tar -tf {};"
FZF_DEFAULT_PREVIEW+=" elif [[ \$(echo {} | tail -c 7) = 'tar.xz' ]] then"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[TAR file]${COLOR_NONE}\";"
FZF_DEFAULT_PREVIEW+=" tar -tf {};"
FZF_DEFAULT_PREVIEW+=" elif [[ \$(echo {} | tail -c 3) = 'gz' ]] then"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[GZIP file]${COLOR_NONE}\";"
FZF_DEFAULT_PREVIEW+=" gzip -l {};"
FZF_DEFAULT_PREVIEW+=" elif [[ -L {} ]] && [[ -f {} ]] then"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[symlink of \$(readlink -f {})]${COLOR_NONE}\";"
FZF_DEFAULT_PREVIEW+=" bat --style=numbers --color=always --tabs 2 --line-range :${FZF_PREVIEW_LINES} {};"
FZF_DEFAULT_PREVIEW+=" elif [[ \$(file --brief --mime '{}' | grep -c binary) -ne 0 ]] then"
FZF_DEFAULT_PREVIEW+=" echo -e \"${COLOR_BLUE}[Binary file]${COLOR_NONE}\";"
FZF_DEFAULT_PREVIEW+=" file --brief {};"
FZF_DEFAULT_PREVIEW+=" elif [[ -f {} ]] then"
FZF_DEFAULT_PREVIEW+=" bat --style=numbers --color=always --tabs 2 --line-range :${FZF_PREVIEW_LINES} {};"
FZF_DEFAULT_PREVIEW+=" fi"
FZF_DEFAULT_OPTS+=" --border --layout=reverse --multi"
FZF_DEFAULT_OPTS+=" --color fg:#ebdbb2,bg:#282828,hl:#fabd2f,fg+:#ebdbb2,bg+:#3c3836,hl+:#fabd2f,gutter:#282828"
FZF_DEFAULT_OPTS+=" --color info:#83a598,prompt:#bdae93,spinner:#fabd2f,pointer:#83a598,marker:#fe8019,header:#665c54"
FZF_DEFAULT_OPTS+=" --bind 'alt-up:preview-page-up' --bind 'alt-down:preview-page-down'"
FZF_DEFAULT_OPTS+=" --bind 'alt-left:preview-top' --bind 'alt-right:preview-bottom'"
FZF_DEFAULT_OPTS+=" --bind '?:toggle-preview' --bind 'alt-w:toggle-preview-wrap'"
FZF_DEFAULT_OPTS+=" --preview-window=down:50% --preview '${FZF_DEFAULT_PREVIEW}'"
export FZF_DEFAULT_OPTS
export FZF_CTRL_R_OPTS="--preview 'echo {}' --preview-window=down:3:wrap"
export FZF_CTRL_T_COMMAND="${FZF_DEFAULT_COMMAND}"
export FZF_CTRL_T_OPTS="--preview-window=right:50%"
export FZF_ALT_C_COMMAND="fd --type d --hidden --exclude '.clangd'"
export FZF_ALT_C_OPTS="--preview 'echo -e \"${COLOR_BLUE}[Directory]${COLOR_NONE}\" {}; exa --all --long --header --color=always {}' --preview-window=right:60%"
